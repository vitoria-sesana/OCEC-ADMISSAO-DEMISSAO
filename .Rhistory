Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(ocupacao_criativo)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
tab_var_abs
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
View(tab_var_abs)
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo")]
tab_var_abs
base_total_empregos_muni_ES_2023
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes, id_municipio)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo")]
View(tab_var_abs)
12*78
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo")]
tab_var_abs
tab_var_abs <- setorder(tab_var_abs, mes)
tab_var_abs
base_total_empregos_ES_2023
base_total_empregos_ES_2023
base_total_empregos_muni_ES_2023
tab_var_abs <- setorder(tab_var_abs, mes)
base_total_empregos_ES_2023
base_total_empregos_muni_ES_2023
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs, mes)
base_total_empregos_ES_2023
base_total_empregos_muni_ES_2023
base_total_empregos_ES_2023
base_total_empregos_muni_ES_2023
tab_var_abs
tab_var_relativo <- tab_var_abs[.(mes, Var_abs),]
tab_var_relativo <- tab_var_abs[c(mes, Var_abs),]
tab_var_abs[c(mes, Var_abs),]
tab_var_abs[mes, Var_abs,]
tab_var_abs[.("mes", "Var_abs"),]
tab_var_abs[,]
tab_var_abs[mes,]
tab_var_abs["mes",]
tab_var_abs[,mes]
tab_var_abs[,.(mes,Var_abs)]
tab_var_relativo <- tab_var_abs[,.(mes,Var_abs)]
tab_var_relativo <- tab_var_abs[(0,0),.(mes,Var_abs)]
tab_var_relativo <- tab_var_abs[,.(mes,Var_abs)]
tab_var_relativo <- tab_var_abs[,.(mes,Var_abs+base_total_empregos_ES_2023)]
tab_var_relativo
tab_var_relativo <- tab_var_abs[,.(mes,Var_abs)]
tab_var_relativo
base_total_empregos_ES_2023
tab_var_relativo[, qntd_emprego_fdm := base_total_empregos_ES_2023 + cusum(Var_abs)]
tab_var_relativo[, qntd_emprego_fdm := base_total_empregos_ES_2023 + cumsum(Var_abs)]
# total de empregos por mes -----------------------------------------------
tab_var_relativo <- tab_var_abs[,.(mes,Var_abs)]
tab_var_relativo[, qntd_emprego_fdm := base_total_empregos_ES_2023 + cumsum(Var_abs)]
# total de empregos por mes -----------------------------------------------
tab <- tab_var_abs[,.(mes,Var_abs)]
tab[, qntd_emprego_fdm := base_total_empregos_ES_2023 + cumsum(Var_abs)]
tab
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,Var_abs)]
tab[, qntd_emprego_fdm := base_total_empregos_ES_2023 + cumsum(Var_abs)]
tab
1085430+316
1085430+3616
1085430+3616+4754
tab[, qntd_emprego_cdm := qntd_emprego_fdm - cumsum(Var_abs)]
tab
tab[, qntd_emprego_cdm := qntd_emprego_fdm - Var_abs]
tab
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(Var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - Var_abs]
tab
tab <- tab_var_abs[,.(mes,Var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(Var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - Var_abs]
tab
tab <- tab_var_abs[,.(mes,Var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(Var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - Var_abs]
tab
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs, mes)
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs, mes)
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,Var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(Var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - Var_abs]
tab[, var_relativo := ]
tab
tab[, var_relativo := ((qntd_emprego_final_mes-1)/qntd_emprego_comeco_mes)*100]
tab
tab[, var_relativo := (var_abs/qntd_emprego_comeco_mes)*100]
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs, mes)
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - var_abs]
tab[, var_relativo := (var_abs/qntd_emprego_comeco_mes)*100]
tab
tab[, ind_emprego := (qntd_emprego_final_mes/qntd_emprego_comeco_mes)*100]
tab_var_relativo
tab <- tab_var_abs[,.(mes,var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - var_abs]
tab[, var_relativo := (var_abs/qntd_emprego_comeco_mes)*100]
tab[, ind_emprego := (qntd_emprego_final_mes/qntd_emprego_comeco_mes)*100]
tab_var_relativo
tab
tab[, ind_emprego := (qntd_emprego_final_mes*100)/qntd_emprego_comeco_mes)]
tab[, ind_emprego := (qntd_emprego_final_mes*100)/qntd_emprego_comeco_mes]
tab
tab[, ind_emprego := (qntd_emprego_final_mes/qntd_emprego_comeco_mes)*100]
tab
tab[, ind_emprego := (qntd_emprego_final_mes/qntd_emprego_comeco_mes)*100]
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := saldo_adm + saldo_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(saldo_adm, saldo_dem,tab_var_abs, mes)
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := saldo_adm + saldo_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(saldo_adm, saldo_dem,tab_var_abs, mes)
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := saldo_adm + saldo_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(mes)
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := saldo_adm + saldo_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(mes)
View(tab_var_abs)
tab_var_abs <- setorder(tab_var_abs,mes)
tab <- tab_var_abs[,.(mes,saldo_adm, saldo_dem, var_abs)]
tab[, qntd_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
tab[, qntd_emprego_comeco_mes := qntd_emprego_final_mes - var_abs]
tab[, var_relativo := (var_abs/qntd_emprego_comeco_mes)*100]
tab[, ind_emprego := (qntd_emprego_final_mes/qntd_emprego_comeco_mes)*100]
tab
tab[, taxa_rotatividade := (min(saldo_adm, abs(saldo_dem))/qntd_emprego_comeco_mes)*100]
tab
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := saldo_adm + saldo_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs,mes)
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,saldo_adm, saldo_dem, var_abs)]
tab[, total_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
tab[, total_emprego_comeco_mes := total_emprego_final_mes - var_abs]
tab[, var_relativo := (var_abs/total_emprego_comeco_mes)*100]
tab[, ind_emprego := (total_emprego_final_mes/total_emprego_comeco_mes)*100]
tab[, taxa_rotatividade := (min(saldo_adm, abs(saldo_dem))/total_emprego_comeco_mes)*100]
tab
View(tab)
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,saldo_adm, saldo_dem, var_abs)]
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
total_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
total_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := total_adm + total_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs,mes)
base %>% head(100) %>% View
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
total_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
total_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := total_adm + total_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs,mes)
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,saldo_adm, saldo_dem, var_abs)]
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
total_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
total_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, var_abs := total_adm + total_dem]
tab_var_abs[, var_abs_class := fifelse(var_abs > 0, "Positivo", "Negativo")]
tab_var_abs <- setorder(tab_var_abs,mes)
# total de empregos por mes -----------------------------------------------
base_total_empregos_ES_2023
tab <- tab_var_abs[,.(mes,saldo_adm, saldo_dem, var_abs)]
tab[, total_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
tab <- tab_var_abs[,.(mes,total_adm, total_dem, var_abs)]
tab[, total_emprego_final_mes := base_total_empregos_ES_2023 + cumsum(var_abs)]
tab[, total_emprego_comeco_mes := total_emprego_final_mes - var_abs]
tab[, var_relativo := (var_abs/total_emprego_comeco_mes)*100]
tab[, ind_emprego := (total_emprego_final_mes/total_emprego_comeco_mes)*100]
tab[, taxa_rotatividade := (min(total_adm, abs(total_dem))/total_emprego_comeco_mes)*100]
tab
View(tab)
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(ocupacao_criativo)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
tab_var_abs
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(ocupacao_criativo)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
tab_var_abs
## gráfico -----------------------------------------------------------------
ggplot(tab_var_abs, aes(x = ocupacao_criativo, y = Var_abs)) +
geom_bar(stat = "identity") +
labs(title = "Saldo anual (2024) entre criativos e não criativos",
x = "Categoria",
y = "Valor") +
theme_minimal() +
theme(
panel.grid.major.x = element_blank()
)
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# variação absoluta -------------------------------------------------------
tab_var_abs <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes)]
tab_var_abs[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
## gráfico -----------------------------------------------------------------
ggplot(tab_var_abs, aes(x = mes, y = Var_abs, fill = Var_abs_class)) +
geom_bar(stat = "identity") +
labs(title = "Saldo mensal no ES",
x = "Categoria",
y = "Valor") +
theme_minimal() +
theme(
panel.grid.major.x = element_blank()
)
# variação absoluta: criativos e não criativos ----------------------------
tab_var_abs_cri <-
base[, .(
Total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(mes,ocupacao_criativo)]
tab_var_abs_cri[, Var_abs := Saldo_adm + Saldo_dem]
tab_var_abs_cri[, Var_abs_class := fifelse(Var_abs > 0, "Positivo", "Negativo") ]
tab_var_abs_cri[, classe_plot := paste(ocupacao_criativo, "-", Var_abs_class)]
## gráfico -----------------------------------------------------------------
ggplot(tab_var_abs_cri,
aes(x = mes, y = Var_abs, fill = ocupacao_criativo)) +
geom_bar(stat = "identity") +
labs(title = "Saldo mensal entre criativos e não criativos",
x = "Categoria",
y = "Valor") +
theme_minimal() +
theme(
panel.grid.major.x = element_blank()
)
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# gráfico linha cruzado mensal: movimentação x setor criativo -------------
g_01 <-
base[, .(Total = .N, Saldo = sum(saldo_movimentacao)),
by = .(tipo_movimentacao_agrup, ocupacao_criativo, mes)]
g_01[, mes := as.integer(mes)]
g_01[, classe := paste(ocupacao_criativo,"-", tipo_movimentacao_agrup)]
g_01[, Percentual := Total / sum(Total) * 100, by = mes]
cores <- c("Ocupação não Criativa - Admissão" = "#1f77b4",
"Ocupação não Criativa - Desligamento" = "#ff7f0e",
"Ocupação Criativa - Desligamento" = "#2ca02c",
"Ocupação Criativa - Admissão" = "#d62728")
ggplot(g_01, aes(x = mes, y = Total, color = classe)) +
geom_line(size = 1) +
scale_color_manual(values = cores) +
labs(title = "Gráfico de linha para a quantidade total de admitidos e demitidos entre as ocupações criativos e não criativos",
x = "Mês",
y = "Percentual (%)",
color = "Classe") +
theme_minimal() +
scale_x_continuous(breaks = seq(1,12,1))
# percentual --------------------------------------------------------------
ggplot(g_01, aes(x = mes, y = Percentual, color = classe)) +
geom_line(size = 1) +
scale_color_manual(values = cores) +
labs(title = "Gráfico de linha para o percentual de admitidos e demitidos entre as ocupações criativos e não criativos",
x = "Mês",
y = "Percentual (%)",
color = "Classe") +
theme_minimal() +
scale_x_continuous(breaks = seq(1,12,1))
# rotina ------------------------------------------------------------------
source("scripts/a-microdados/0-rotina.R", encoding = "UTF-8")
# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# saldo municipios --------------------------------------------------------
# +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
tab_muni <-
base[, .(total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)),
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0))),
by = .(id_municipio)]
tab_muni[, Var_abs := Saldo_adm + Saldo_dem]
tab_muni
### gráfico boxplot ------------------------
ggplot(tab_muni, aes(x = Var_abs)) +
geom_boxplot(fill = "lightgreen", color = "black") +
labs(title = "Boxplot do Ano", x = "Ano") +
theme_minimal()
### gráfico espacial ------------------------
municipios_es <- read_municipality(code_muni = "ES", year = 2020)
tab_muni_df <- as.data.frame(tab_muni)
municipios_es_joined <- municipios_es %>%
left_join(tab_muni_df, by = c("code_muni" = "id_municipio"))
ggplot(municipios_es_joined) +
geom_sf(aes(fill = Var_abs), color = "black") +  # Use Var_abs com sinal original
scale_fill_gradient2(
low = "red",         # Valores negativos em vermelho
mid = "white",       # Valor zero em branco
high = "green",      # Valores positivos em verde
midpoint = 0,        # Zero no meio do gradiente
na.value = "grey90", # Cor para NA
name = "Saldo"
) +
scale_x_continuous(limits = c(-42, -39)) +
labs(title = "Saldo por Município no ES (Ocupação Criativa)") +
theme_minimal()
tab_muni_criativo <- base[, .(
total = .N,
Saldo_adm = sum(ifelse(saldo_movimentacao == 1, saldo_movimentacao, 0)) + 0.0,
Saldo_dem = sum(ifelse(saldo_movimentacao == -1, saldo_movimentacao, 0)) + 0.0
), by = .(id_municipio, ocupacao_criativo)]
tab_muni_criativo[, Var_abs := Saldo_adm + Saldo_dem]
tab_muni_criativo
### gráfico boxplot ------------------------
ggplot(tab_muni_criativo, aes(x = ocupacao_criativo, y = Var_abs, colour = ocupacao_criativo)) +
geom_boxplot(fill = "lightgreen", color = "black") +
labs(title = "Boxplot de Var_abs por Ocupação Criativa", x = "Ocupação Criativa", y = "Var_abs") +
theme_minimal() +
theme(legend.position = "none") +
scale_y_continuous(breaks = seq(-100, 6500, 500))
### gráfico espacial ------------------------
municipios_es <- read_municipality(code_muni = "ES", year = 2020)
tab_muni_df <- as.data.frame(tab_muni_criativo[ocupacao_criativo == "Ocupação Criativa", ])
municipios_es_joined <- municipios_es %>%
left_join(tab_muni_df, by = c("code_muni" = "id_municipio"))
ggplot(municipios_es_joined) +
geom_sf(aes(fill = Var_abs), color = "black") +
scale_fill_gradient2(
low = "red",         # Valores negativos em vermelho
mid = "white",       # Valor zero em branco
high = "green",      # Valores positivos em verde
midpoint = 0,        # Zero no meio do gradiente
na.value = "grey90", # Cor para NA
name = "Saldo",
breaks = seq(-1000, 6000, 1000),
) +
scale_x_continuous(limits = c(-42, -39)) +
labs(title = "Saldo por Município no ES (Ocupação Criativa)") +
theme_minimal()
