base <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
base <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
View(base)
base <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
UF_escolhida <- 32
inicio <- mapa_caract[UF==UF_escolhida,Inicial]
final <- mapa_caract[UF==UF_escolhida,Final]
base <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
UF_escolhida <- 32inicio <- mapa_caract[uf==UF_escolhida,Inicial]
UF_escolhida <- 32
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
dado <- fread( file = caminho ,
sep = ";" , dec = "," ,
select = 26L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
dado <- arrow::fread( file = caminho ,
sep = ";" , dec = "," ,
select = 26L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
dado <- data.table::fread( file = caminho ,
sep = ";" , dec = "," ,
select = 26L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
View(dado)
dado <- data.table::fread( file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
library(data.table)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,     # encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
dado[,uf:=stringr::str_sub(as.character(municipio), end = 2)]
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
View(mapa_caract)
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
primeira_linha <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
library(data.table)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
primeira_linha <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,     # encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1,
skip = inicio,
nrows = final-inicio
)
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
header = T,
data.table = TRUE,
skip = inicio,
nrows = final-inicio
)
arrow::write_parquet(dado, "bases/CAGED_ES_202507.parquet")
View(primeira_linha)
base <-
arrow::read_parquet("bases/CAGED_ES_202507.parquet")
# desenvolver rotina para obter a base anual
# tem 3 opções de bases para coletar no servidor do mte
library(data.table)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
primeira_linha <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
header = T,
data.table = TRUE,
skip = inicio,
nrows = final-inicio
)
View(dado)
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
# header = T,
data.table = TRUE,
skip = inicio,
nrows = final-inicio
)
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
# header = T,
# data.table = TRUE,
skip = inicio,
nrows = final-inicio
)
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
# header = T,
# data.table = TRUE,
skip = inicio,
nrows = final-inicio,
showProgress = FALSE
)
# desenvolver rotina para obter a base anual
# tem 3 opções de bases para coletar no servidor do mte
library(data.table)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
primeira_linha <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |> janitor::clean_names()
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
# header = T,
# data.table = TRUE,
skip = inicio,
nrows = final-inicio,
showProgress = FALSE
)
View(dado)
dado <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
# header = T,
data.table = TRUE,
skip = inicio,
nrows = final-inicio,
showProgress = FALSE
)
View(dado)
dado_completo <- fread(
file = caminho,
sep = ";", dec = ",",
data.table = TRUE,
showProgress = FALSE
)
# Ordena pela terceira coluna
setorder(dado_completo, ..names(dado_completo)[3])
View(dado_completo)
dado_completo %>% colnames()
colnames(dado_completo)
# Ordena pela terceira coluna
setorder(dado_completo, uf)
# Aplica o filtro de linhas equivalente a skip/nrows
dado <- dado_completo[(inicio + 1):(final)]
View(dado)
setorder(dado, uf)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |>
janitor::clean_names()
setorder(dado, uf)
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
View(mapa_caract)
dado_completo <- fread(
file = caminho,
sep = ";", dec = ",",
data.table = TRUE,
showProgress = FALSE
)
# Ordena pela terceira coluna
setorder(dado_completo, uf)
# Aplica o filtro de linhas equivalente a skip/nrows
dado <- dado_completo[(inicio + 1):(final)]
arrow::write_parquet(dado, "bases/CAGED_ES_202507.parquet")
base <-
arrow::read_parquet("bases/CAGED_ES_202507.parquet")
View(base)
base <-
arrow::read_parquet("bases/CAGED_ES_202507.parquet")
base[,.(Total=.N),by=tipomovimentação]
dado_completo <- fread(
file = caminho,
sep = ";", dec = ",",
data.table = TRUE,
showProgress = FALSE
) |>
janitor::clean_names()
# desenvolver rotina para obter a base anual
# tem 3 opções de bases para coletar no servidor do mte
library(data.table)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
primeira_linha <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |>
janitor::clean_names()
setorder(dado, uf)
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
# dado <-
#   data.table::fread(
#     file = caminho,
#     sep = ";", dec = ",",
#     # encoding = "Latin-1" ,
#     # header = T,
#     data.table = TRUE,
#     skip = inicio,
#     nrows = final-inicio,
#     showProgress = FALSE
#     )
dado_completo <- fread(
file = caminho,
sep = ";", dec = ",",
data.table = TRUE,
showProgress = FALSE
) |>
janitor::clean_names()
# Ordena pela terceira coluna
setorder(dado_completo, uf)
# Aplica o filtro de linhas equivalente a skip/nrows
dado <- dado_completo[(inicio + 1):(final)]
arrow::write_parquet(dado, "bases/CAGED_ES_202507.parquet")
base <-
arrow::read_parquet("bases/CAGED_ES_202507.parquet")
base[,.(Total=.N),by = tipomovimentacao]
x <- base[,.(Total=.N),by = tipomovimentacao]
View(x)
x$Total |> sum
x$Total |> sum()
