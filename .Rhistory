group_by(setor_criativo, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
mutate(classe = setor_criativo) |>
select(classe, ano, trimestre, resultados)
referencia_criativos <-
tabela_criativos_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_criativos_trimestral <-
left_join(tabela_criativos_trimestral, referencia_criativos, by = "classe")
View(tabela_criativos_trimestral)
tabela_criativos_trimestral <-
left_join(tabela_criativos_trimestral, referencia_criativos, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
referencia_criativos <-
tabela_criativos_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_criativos_trimestral <-
left_join(tabela_criativos_trimestral, referencia_criativos, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
View(referencia_criativos)
tabela_criativos_trimestral <-
tabela_criativos |>
mutate(
trimestre = case_when(
mes %in% c(1,2,3) ~ "I",
mes %in% c(4,5,6) ~ "II",
mes %in% c(7,8,9) ~ "III",
mes %in% c(10,11,12) ~ "IV"
)
) |>
group_by(setor_criativo, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
mutate(classe = setor_criativo) |>
select(classe, ano, trimestre, resultados)
referencia_criativos <-
tabela_criativos_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_criativos_trimestral <-
left_join(tabela_criativos_trimestral, referencia_criativos, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
View(tabela_criativos_trimestral)
referencia_criativos <-
tabela_criativos_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_criativos_trimestral <-
left_join(tabela_criativos_trimestral, referencia_criativos, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
tabela_criativos_trimestral <-
tabela_criativos |>
mutate(
trimestre = case_when(
mes %in% c(1,2,3) ~ "I",
mes %in% c(4,5,6) ~ "II",
mes %in% c(7,8,9) ~ "III",
mes %in% c(10,11,12) ~ "IV"
)
) |>
group_by(setor_criativo, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
mutate(classe = setor_criativo) |>
select(classe, ano, trimestre, resultados)
referencia_criativos <-
tabela_criativos_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_criativos_trimestral <-
left_join(tabela_criativos_trimestral, referencia_criativos, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
tabela_geral_trimestral <-
tabela_geral |>
mutate(
trimestre = case_when(
mes %in% c(1,2,3) ~ "I",
mes %in% c(4,5,6) ~ "II",
mes %in% c(7,8,9) ~ "III",
mes %in% c(10,11,12) ~ "IV"
)
) |>
group_by(setor_criativo, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
mutate(classe = setor_criativo) |>
select(classe, ano, trimestre, resultados)
tabela_geral_trimestral <-
tabela_geral |>
mutate(
trimestre = case_when(
mes %in% c(1,2,3) ~ "I",
mes %in% c(4,5,6) ~ "II",
mes %in% c(7,8,9) ~ "III",
mes %in% c(10,11,12) ~ "IV"
)
) |>
group_by(setor_criativo, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
select(classe, ano, trimestre, resultados)
tabela_geral_trimestral <-
tabela_geral |>
mutate(
trimestre = case_when(
mes %in% c(1,2,3) ~ "I",
mes %in% c(4,5,6) ~ "II",
mes %in% c(7,8,9) ~ "III",
mes %in% c(10,11,12) ~ "IV"
)
) |>
group_by(classe, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
select(classe, ano, trimestre, resultados)
referencia_geral <-
tabela_geral_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_geral_trimestral <-
left_join(tabela_geral_trimestral, referencia_geral, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
View(tabela_geral_trimestral)
tabela_geral_trimestral <-
left_join(tabela_geral_trimestral, referencia_geral, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
tabela_geral_trimestral <-
tabela_geral |>
mutate(
trimestre = case_when(
mes %in% c(1,2,3) ~ "I",
mes %in% c(4,5,6) ~ "II",
mes %in% c(7,8,9) ~ "III",
mes %in% c(10,11,12) ~ "IV"
)
) |>
group_by(classe, ano, trimestre) |>
summarise(
resultados = mean(taxa_rotatividade)
) |>
select(classe, ano, trimestre, resultados)
referencia_geral <-
tabela_geral_trimestral |> ungroup() |>
filter(ano == 2024 & trimestre == "IV") |>
select(classe, resultados) |>
rename(resultados_referencia = resultados)
tabela_geral_trimestral <-
left_join(tabela_geral_trimestral, referencia_geral, by = "classe") |>
mutate(
resultados_base100 = round((resultados/resultados_referencia), 3)
)
referencia_pib <-
tabela_pib |>
filter(trimestre == "IV" & ano == 2024) |>
mutate(pib_nominal_ajustado_ao_benchmark_anual = as.numeric(pib_nominal_ajustado_ao_benchmark_anual))
tabela_pib_trimestral <-
tabela_pib |>
mutate(
classe = "Pib",
pib = as.numeric(pib_nominal_ajustado_ao_benchmark_anual),
e0_pib = as.numeric(referencia_pib$pib_nominal_ajustado_ao_benchmark_anual),
resultados = pib,
resultados_base100 = round((pib / e0_pib), 3)
) |>
select(classe, ano, trimestre, resultados, resultados_base100)
tabela_completa <-
bind_rows(tabela_geral_trimestral, tabela_pib_trimestral) |>
mutate(trimestre = factor(trimestre, levels = c("I", "II", "III", "IV"))) |>
mutate(tempo = paste(ano, trimestre, sep = " - ")) |>
arrange(ano, trimestre) %>%
mutate(tempo = factor(tempo, levels = unique(tempo)))
cores <- c("Setor criativo" = "#1f77b4",
"Setor não criativo" = "gray",
"Geral" = "red",
"Pib" = "black")
ggplot(
tabela_completa,
aes(
x = tempo,
y = resultados,
color = classe,
group = classe
)
) +
geom_line(size = 1) +
scale_color_manual(values = cores) +
theme_minimal() +
# scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
scale_y_continuous(
#breaks = seq(0.5,1.5,0.1),
limits = c(0, 61)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("2008-2024")
ggplot(
tabela_completa,
aes(
x = tempo,
y = resultados,
color = classe,
group = classe
)
) +
geom_line(size = 1) +
scale_color_manual(values = cores) +
theme_minimal() +
# scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
scale_y_continuous(
#breaks = seq(0.5,1.5,0.1),
limits = c(0, 7)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("2008-2024")
ggplot(
tabela_completa,
aes(
x = tempo,
y = resultados_base100,
color = classe,
group = classe
)
) +
geom_line(size = 1) +
scale_color_manual(values = cores) +
theme_minimal() +
# scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
scale_y_continuous(
#breaks = seq(0.5,1.5,0.1),
limits = c(0, 2)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("2008-2024")
ggplot(
tabela_completa,
aes(
x = tempo,
y = resultados_base100,
color = classe,
group = classe
)
) +
geom_line(size = 1) +
geom_hline(
yintercept = 1,
linetype = "dashed",
color = "black",
linewidth = 0.8
) +
scale_color_manual(values = cores) +
theme_minimal() +
# scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
scale_y_continuous(
#breaks = seq(0.5,1.5,0.1),
limits = c(0, 2)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("2008-2024")
ggplot(
tabela_completa,
aes(
x = tempo,
y = resultados_base100,
color = classe,
group = classe
)
) +
geom_line(size = 1) +
geom_hline(
yintercept = 1,
linetype = "dashed",
color = "pink",
linewidth = 0.8
) +
scale_color_manual(values = cores) +
theme_minimal() +
# scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
scale_y_continuous(
#breaks = seq(0.5,1.5,0.1),
limits = c(0, 2)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("2008-2024")
ggplot(
tabela_completa,
aes(
x = tempo,
y = resultados_base100,
color = classe,
group = classe
)
) +
geom_line(size = 1) +
geom_hline(
yintercept = 1,
linetype = "dashed",
color = "green",
linewidth = 0.8
) +
scale_color_manual(values = cores) +
theme_minimal() +
# scale_x_date(date_breaks = "6 months", date_labels = "%b %Y") +
scale_y_continuous(
#breaks = seq(0.5,1.5,0.1),
limits = c(0, 2)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
ggtitle("2008-2024")
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
# leitura -----------------------------------------------------------------
tabela_trimestral <-
read.csv2(
"scripts/a-microdados/h-completo/saidas/tabela_trimestral.csv"
) %>%
select(classe, resultados, resultados_base100, tempo)
library(tidyverse)
library(dplyr)
tabela_trimestral <-
read.csv2(
"scripts/a-microdados/h-completo/saidas/tabela_trimestral.csv"
) %>%
select(classe, resultados, resultados_base100, tempo)
base_ts <- tabela_trimestral %>%
mutate(
ano = as.numeric(substr(tempo, 1, 4)),
trimestre = case_when(
grepl(" - I$",  tempo) ~ 1,
grepl(" - II$", tempo) ~ 2,
grepl(" - III$", tempo) ~ 3,
grepl(" - IV$", tempo) ~ 4
)
) %>%
arrange(classe, ano, trimestre)
cria_ts <- function(df, variavel) {
ts(
df[[variavel]],
start = c(min(df$ano), min(df$trimestre)),
frequency = 4
)
}
ts_criativo_resultados <- base_ts %>%
filter(classe == "Setor criativo") %>%
cria_ts("resultados")
ts_criativo_base100 <- base_ts %>%
filter(classe == "Setor criativo") %>%
cria_ts("resultados_base100")
ts_nao_criativo_resultados <- base_ts %>%
filter(classe == "Setor não criativo") %>%
cria_ts("resultados")
ts_nao_criativo_base100 <- base_ts %>%
filter(classe == "Setor não criativo") %>%
cria_ts("resultados_base100")
ts_pib_resultados <- base_ts %>%
filter(classe == "Pib") %>%
cria_ts("resultados")
ts_pib_base100 <- base_ts %>%
filter(classe == "Pib") %>%
cria_ts("resultados_base100")
# validacao
frequency(ts_pib_resultados)
start(ts_pib_resultados)
end(ts_pib_resultados)
decomp <- decompose(ts_criativo_resultados)
plot(decomp)
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
decomp <- decompose(ts_criativo_resultados)
plot(decomp)
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
acf(ts_criativo_resultados, main = "ACF")
pacf(ts_criativo_resultados, main = "PACF")
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
adf.test(ts_criativo_resultados)
# analises temporais ------------------------------------------------------
# tendencia, sazonalidade, ciclos e pontos atípicos
# checar estacionariedade (não faz sentido para o nosso problema, não queremos modelar)
# verificar autocorrelação (parcial e simples)
# modelo é aditivo ou multiplicativo
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
# analises temporais ------------------------------------------------------
# tendencia, sazonalidade, ciclos e pontos atípicos
# checar estacionariedade (não faz sentido para o nosso problema, não queremos modelar)
# verificar autocorrelação (parcial e simples)
# modelo é aditivo ou multiplicativo
describe(ts_criativo_resultados)
library(psych)
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
describe(ts_criativo_base100)
plot(ts_criativo_base100, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
describe(ts_criativo_base100)
plot(ts_criativo_base100, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
describe(ts_criativo_base100)
plot(ts_criativo_base100, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
stl_decomp <- stl(ts_criativo_base100, s.window = "periodic")
plot(stl_decomp)
acf(ts_criativo_resultados, main = "ACF")
pacf(ts_criativo_resultados, main = "PACF")
acf(ts_criativo_base100, main = "ACF")
pacf(ts_criativo_base100, main = "PACF")
adf.test(ts_criativo_resultados)
tseries::adf.test(ts_criativo_resultados)
# correlação cruzada ------------------------------------------------------
autoplot(cbind(ts_criativo_resultados, ts_nao_criativo_resultados)) +
labs(title = "Comparação das Séries")
ccf(serie1_diff, serie2_diff, lag.max = 12, main = "Correlação Cruzada")
tseries::adf.test(ts_criativo_resultados) # não estacionária
tseries::adf.test(ts_nao_criativo_resultados) # não estacionária
x <- rnorm(1000)  # no unit-root
adf.test(x)
tseries::adf.test(x)
x <- rnorm(1000)  # no unit-root
plot(x)
x <- rnorm(1000)  # no unit-root
tseries::adf.test(x)
plot(x)
# correlação cruzada ------------------------------------------------------
autoplot(cbind(ts_criativo_resultados, ts_nao_criativo_resultados)) +
labs(title = "Comparação das Séries")
ccf(serie1_diff, serie2_diff, lag.max = 12, main = "Correlação Cruzada")
serie1_diff <- diff(serie1)
serie2_diff <- diff(serie2)
serie1_diff <- diff(ts_criativo_resultados)
serie2_diff <- diff(ts_nao_criativo_resultados)
serie1_diff <- diff(ts_criativo_resultados, lag = 12)
serie2_diff <- diff(ts_nao_criativo_resultados, lag = 12)
adf.test(serie1_diff)
tseries::adf.test(serie1_diff)
tseries::adf.test(serie2_diff)
tseries::adf.test(serie1_diff)
serie1_diff <- diff(ts_criativo_resultados)
serie2_diff <- diff(ts_nao_criativo_resultados)
serie1_diff <- diff(ts_criativo_resultados, lag = 12)
serie2_diff <- diff(ts_nao_criativo_resultados, lag = 12)
tseries::adf.test(serie1_diff)
tseries::adf.test(serie2_diff)
ccf(serie1_diff, serie2_diff, lag.max = 12, main = "Correlação Cruzada")
cor(serie1_diff, serie2_diff, use = "complete.obs")
serie1_diff <- diff(ts_criativo_resultados)
serie2_diff <- diff(ts_nao_criativo_resultados)
cor(serie1_diff, serie2_diff, use = "complete.obs") # sem defasagem
ccf(serie1_diff, serie2_diff, lag.max = 12, main = "Correlação Cruzada")
cor(serie1_diff, serie2_diff, use = "complete.obs") # sem defasagem
ccf(serie1_diff, serie2_diff, lag.max = 12, main = "Correlação Cruzada")
cor(serie1_diff, serie2_diff, use = "complete.obs") # sem defasagem
cor(serie1_diff, serie2_diff, use = "complete.obs") # sem defasagem
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
stl_decomp <- stl(ts_criativo_resultados, s.window = "periodic")
plot(stl_decomp)
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
decomposicao <- stl(ts_criativo_resultados, s.window = "periodic")
plot(decomposicao)
acf(ts_criativo_resultados, main = "ACF")
pacf(ts_criativo_resultados, main = "PACF")
tseries::adf.test(ts_criativo_resultados) # não estacionária
tseries::adf.test(ts_nao_criativo_resultados) # não estacionária
# nao criativo
describe(ts_nao_criativo_resultados)
# criativo
describe(ts_criativo_resultados)
plot(ts_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
decomposicao <- stl(ts_criativo_resultados, s.window = "periodic")
plot(decomposicao)
acf(ts_criativo_resultados, main = "ACF")
pacf(ts_criativo_resultados, main = "PACF")
tseries::adf.test(ts_criativo_resultados) # não estacionária
# nao criativo
describe(ts_nao_criativo_resultados)
plot(ts_nao_criativo_resultados, main = "Série Temporal", ylab = "Valor", xlab = "Tempo")
decomposicao <- stl(ts_nao_criativo_resultados, s.window = "periodic")
plot(decomposicao)
acf(ts_nao_criativo_resultados, main = "ACF")
pacf(ts_nao_criativo_resultados, main = "PACF")
tseries::adf.test(ts_nao_criativo_resultados) # não estacionária
