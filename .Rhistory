# tratar o tipo de movimentação (admissão e demissão)
# classificar o setor, segmento e atividade criativa
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
codigos_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
# classificação: movimentação ---------------------------------------------
base[,.(Total=.N),by = tipomovimentacao]
admissoes <-
c(10, 20, 25, 35, 70)
desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
outros <-
c(33, 98, 97, 99)
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% codigos_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
base$ocupacao_criativo
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% codigos_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
base$ocupacao_criativo
# tratar o tipo de movimentação (admissão e demissão)
# classificar o setor, segmento e atividade criativa
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
codigos_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
# classificação: movimentação ---------------------------------------------
base[,.(Total=.N),by = tipomovimentacao]
admissoes <-
c(10, 20, 25, 35, 70)
desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
outros <-
c(33, 98, 97, 99)
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% codigos_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
class(base)
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
codigos_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
setDT(base)
# classificação: movimentação ---------------------------------------------
base[,.(Total=.N),by = tipomovimentacao]
admissoes <-
c(10, 20, 25, 35, 70)
desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
outros <-
c(33, 98, 97, 99)
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% codigos_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
# classificar  movimentação (admissão e demissão)
# classificar em criativos e não criativos
# classificar o setor, segmento e atividade criativa??
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
cd_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
setDT(base)
# classificação: movimentação ---------------------------------------------
base[,.(Total=.N),by = tipomovimentacao]
cd_tm_admissoes <-
c(10, 20, 25, 35, 70)
cd_tm_desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
cd_tm_outros <-
c(33, 98, 97, 99)
# classificar  movimentação (admissão e demissão)
# classificar em criativos e não criativos
# classificar o setor, segmento e atividade criativa??
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
cd_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
setDT(base)
# classificação: movimentação ---------------------------------------------
base[,.(Total=.N),by = tipomovimentacao]
cd_tm_admissoes <-
c(10, 20, 25, 35, 70)
cd_tm_desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
cd_tm_outros <-
c(33, 98, 97, 99)
base[, tipomovimentacao_agrup :=
fcase(
tipomovimentacao %in% cd_tm_admissoes, "Admissão",
tipomovimentacao %in% cd_tm_desligamentos, "Desligamento",
tipomovimentacao %in% cd_tm_outros, "Outros",
)
]
base[, tipomovimentacao_agrup :=
fcase(
tipomovimentacao %in% cd_tm_admissoes, "Admissão",
tipomovimentacao %in% cd_tm_desligamentos, "Desligamento",
tipomovimentacao %in% cd_tm_outros, "Outros",
default = NA
)]
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% cd_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
# classificação: movimentação ---------------------------------------------
base[,.(Total=.N),by = tipomovimentacao]
# classificação: movimentação ---------------------------------------------
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
cd_tm_admissoes <-
c(10, 20, 25, 35, 70)
cd_tm_desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
cd_tm_outros <-
c(33, 98, 97, 99)
base[, tipomovimentacao_agrup :=
fcase(
tipomovimentacao %in% cd_tm_admissoes, "Admissão",
tipomovimentacao %in% cd_tm_desligamentos, "Desligamento",
tipomovimentacao %in% cd_tm_outros, "Outros",
default = NA
)]
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% cd_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% cd_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos.")
base[,.(Total=.N),by = tipomovimentacao]
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação agrupado.")
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação agrupado.")
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos.")
base[,.(Total=.N),by = c(tipomovimentacao_agrup,ocupacao_criativo)]
base[,.(Total=.N),by = c(tipomovimentacao_agrup,ocupacao_criativo)]
base[,.(Total=.N),by = .(tipomovimentacao_agrup,ocupacao_criativo)]
base[,.(Total=.N),
by = .(tipomovimentacao_agrup,
ocupacao_criativo)]
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
print("Tabela frequência dos tipos de movimentação agrupado.")
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos.")
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[tipomovimentacao != 97, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base$cbo2002ocupacao %>% unique() %>% length()
library(dplyr)
base$cbo2002ocupacao %>% unique() %>% length()
# classificar  movimentação (admissão e demissão)
# classificar em criativos e não criativos
# classificar o setor, segmento e atividade criativa??
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
cd_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
setDT(base)
# classificação: movimentação ---------------------------------------------
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
cd_tm_admissoes <-
c(10, 20, 25, 35, 70)
cd_tm_desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90)
cd_tm_outros <-
c(33, 98, 97, 99)
base[, tipomovimentacao_agrup :=
fcase(
tipomovimentacao %in% cd_tm_admissoes, "Admissão",
tipomovimentacao %in% cd_tm_desligamentos, "Desligamento",
tipomovimentacao %in% cd_tm_outros, "Outros",
default = NA
)]
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% cd_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
print("Tabela frequência dos tipos de movimentação agrupado.")
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos.")
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
# análises ----------------------------------------------------------------
print("Tabela frequência das ocupações criativas.")
base[,.(Total=.N),by = ocupacao_criativo]
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
print("Tabela frequência dos tipos de movimentação agrupado.")
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos.")
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[tipomovimentacao != 97, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[tipomovimentacao != 97, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[tipomovimentacao != 97, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos - sem o código 97.")
base[tipomovimentacao != 97, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
# há mais autonomos? informais?
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[ocupacao_criativo != "Criativos", .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[ocupacao_criativo != "Ocupação Criativa", .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
print("Tabela frequência dos tipos de movimentação entre criativos.")
base[ocupacao_criativo != "Ocupação Criativa", .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
base[ocupacao_criativo != "Ocupação Criativa", .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao)]
print("Tabela frequência dos tipos de movimentação entre criativos.")
base[ocupacao_criativo != "Ocupação Criativa", .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao)]
base[ocupacao_criativo == "Ocupação Criativa", .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao)]
cd_tm_admissoes <-
c(10, 20, 25, 35, 70, 97)
cd_tm_desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90, 98)
cd_tm_outros <-
c(33, 99)
base[, tipomovimentacao_agrup :=
fcase(
tipomovimentacao %in% cd_tm_admissoes, "Admissão",
tipomovimentacao %in% cd_tm_desligamentos, "Desligamento",
tipomovimentacao %in% cd_tm_outros, "Outros",
default = NA
)]
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% cd_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
# pacotes -----------------------------------------------------------------
library(data.table)
# leitura -----------------------------------------------------------------
caminho_CBO_CRIATIVOS <- "bases/dicionario_CBO_CRIATIVO.csv"
caminho_CAGED_ES_2025 <- "bases/CAGED_ES_202507.parquet"
cd_CBO_CRIATIVOS <-
read.csv(caminho_CBO_CRIATIVOS) |>
janitor::clean_names() |>
unlist() |>
as.integer()
base <-
arrow::read_parquet(caminho_CAGED_ES_2025)
setDT(base)
# classificação: movimentação ---------------------------------------------
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
cd_tm_admissoes <-
c(10, 20, 25, 35, 70, 97)
cd_tm_desligamentos <-
c(31, 32, 40, 43, 45, 50, 60, 80, 90, 98)
cd_tm_outros <-
c(33, 99)
base[, tipomovimentacao_agrup :=
fcase(
tipomovimentacao %in% cd_tm_admissoes, "Admissão",
tipomovimentacao %in% cd_tm_desligamentos, "Desligamento",
tipomovimentacao %in% cd_tm_outros, "Outros",
default = NA
)]
# classificação: ocupação criativos ----------------------------------------------------
base[, ocupacao_criativo :=
fifelse(
cbo2002ocupacao %in% cd_CBO_CRIATIVOS,
"Ocupação Criativa",
"Ocupação não Criativa"
)]
# análises ----------------------------------------------------------------
print("Tabela frequência das ocupações criativas.")
base[,.(Total=.N),by = ocupacao_criativo]
print("Tabela frequência dos tipos de movimentação.")
base[,.(Total=.N),by = tipomovimentacao]
print("Tabela frequência dos tipos de movimentação agrupado.")
base[,.(Total=.N),by = tipomovimentacao_agrup]
print("Tabela frequência dos tipos de movimentação por criativos e não criativos.")
base[, .(Total=.N),
by = .(ocupacao_criativo,
tipomovimentacao_agrup)]
1383/(48193+1383)
(1383/(48193+1383))*100
(48193/(48193+1383))*100
(1331/(50625+1331))*100
(2714/(98819+2714))*100
caminho <- "bases/CAGED2024/"
tipo <- "MOV" # MOV, FOR ou EXC
ano <- 2024
paste0(
"CAGED",
tipo,
ano
)
paste0(
caminho,
"CAGED",
tipo,
ano
)
"bases/CAGEDMOV202507.7z"
caminho <- "bases/CAGED2024/"
tipo <- "MOV" # MOV, FOR ou EXC
ano <- 2024
arquivo <- ".zip" # .zip ou .txt
paste0(
caminho,
"CAGED",
tipo,
ano,
)
paste0(
caminho,
"CAGED",
tipo,
ano,
arquivo
)
paste0(
caminho,
"CAGED",
tipo,
ano,
arquivo
)
paste0(
"CAGED",
tipo,
ano
)
library(data.table)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
primeira_linha <-
data.table::fread(
file = caminho,
sep = ";", dec = ",",
# encoding = "Latin-1" ,
data.table = TRUE ,
nrows = 1
)
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |>
janitor::clean_names()
setorder(dado, uf)
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
paste0(
"CAGED",
tipo,
ano
)
library(data.table)
caminho <- "bases/CAGEDMOV202507/CAGEDMOV202507.txt"
dado <-
fread(
file = caminho ,
sep = ";" , dec = "," ,
select = 3L,
header = T ,
# encoding = "Latin-1" ,
data.table = TRUE ,
showProgress = FALSE ) |>
janitor::clean_names()
setorder(dado, uf)
mapa_caract <- dado[,.(Total=.N),by=uf]
mapa_caract[,Inicial:=cumsum(Total)-Total]
mapa_caract[,Final:=cumsum(Total)]
UF_escolhida <- "32"
inicio <- mapa_caract[uf==UF_escolhida,Inicial]
final <- mapa_caract[uf==UF_escolhida,Final]
dado_completo <- fread(
file = caminho,
sep = ";", dec = ",",
data.table = TRUE,
showProgress = FALSE
) |>
janitor::clean_names()
# Ordena pela terceira coluna
setorder(dado_completo, uf)
# filtrando informações ---------------------------------------------------
dado_completo <- fread(
file = caminho,
sep = ";", dec = ",",
data.table = TRUE,
showProgress = FALSE
) |>
janitor::clean_names()
# Ordena pela terceira coluna
setorder(dado_completo, uf)
# Aplica o filtro de linhas equivalente a skip/nrows
dado <- dado_completo[(inicio + 1):(final)]
